# 2026-02-07 è¨˜æ†¶

## CosyVoice èªéŸ³åˆæˆç³»çµ±å»ºç½® ğŸ™ï¸

### Mac mini ç’°å¢ƒï¼ˆå·²å®Œæˆï¼‰
- **è·¯å¾‘**: `~/clawd-assistant/projects/cosyvoice-test/`
- **Python**: conda ç’°å¢ƒ `cosyvoice` (Python 3.10)
- **æ¨¡å‹**: CosyVoice2-0.5B + CosyVoice-300M-SFT
- **æ•ˆèƒ½**: RTF ~4.3ï¼ˆ14ç§’èªéŸ³éœ€67ç§’åˆæˆï¼‰
- **é™åˆ¶**: 8GB RAMï¼Œé€Ÿåº¦è¼ƒæ…¢ä½†å¯ç”¨

### Windows GPU ç’°å¢ƒï¼ˆå·²å®Œæˆï¼‰
- **IP**: 192.168.50.121:50000
- **GPU**: RTX 5080
- **æ¨¡å‹**: Fun-CosyVoice3-0.5B
- **ä»‹é¢**: Gradio WebUIï¼ˆé REST APIï¼‰
- **Gradio API ç«¯é»**:
  - `/generate_seed` - ç”¢ç”Ÿéš¨æ©Ÿç¨®å­
  - `/generate_audio` - ä¸»è¦ TTSï¼ˆå«èªéŸ³å…‹éš†ï¼‰
  - `/change_instruction` - åˆ‡æ›æ“ä½œèªªæ˜
- **å•é¡Œ**: Mac ç„¡æ³•ä¸‹è¼‰ç”Ÿæˆçš„æª”æ¡ˆï¼ˆ403 Forbiddenï¼‰
- **è§£æ±ºæ–¹æ¡ˆ**: éœ€ä¿®æ”¹ webui.py åŠ å…¥ `allowed_paths=["/"]`

### Gradio Client æ•´åˆï¼ˆé€²è¡Œä¸­ï¼‰
- Mac conda ç’°å¢ƒå·²å®‰è£ `gradio_client`
- æˆåŠŸé€£ç·š Windows Gradio WebUI
- éœ€è¦æ¸¬è©¦ `/generate_audio` ç«¯é»çš„å®Œæ•´åƒæ•¸

### è²éŸ³æ¨£æœ¬
| è§’è‰² | æª”æ¡ˆ | åƒè€ƒæ–‡å­— |
|------|------|----------|
| Barry | `/tmp/barry_voice.wav` | å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯Barryï¼Œä»Šå¤©ä¾†è·Ÿå¤§å®¶èŠèŠå°è‚¡çš„èµ°å‹¢ |
| Barry (RWA) | `/tmp/barry_rwa_voice.wav` | æˆ‘å€‘ç›®å‰æ­£åœ¨è©•ä¼°å°‡å¯¦é«”è³‡ç”¢ä»£å¹£åŒ–çš„å¯è¡Œæ€§... |
| Maggie | `/tmp/maggie_voice.wav` | å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯Maggieï¼Œä»Šå¤©ä¾†è·Ÿå¤§å®¶èŠèŠå°è‚¡çš„èµ°å‹¢å’ŒæŠ•è³‡ç­–ç•¥ |

### ä½¿ç”¨æ–¹å¼
```bash
# Mac mini æœ¬åœ°åˆæˆ
conda activate cosyvoice
cd ~/clawd-assistant/projects/cosyvoice-test
python clone_voice.py \
  --ref /tmp/barry_voice.wav \
  --ref_text "åƒè€ƒæ–‡å­—" \
  --text "è¦åˆæˆçš„å…§å®¹" \
  --output output.wav

# Windows APIï¼ˆå¾…ä¿®å¾© 403 å•é¡Œï¼‰
from gradio_client import Client, handle_file
client = Client("http://192.168.50.121:50000")
result = client.predict(
    tts_text="æ–‡å­—",
    mode_checkbox_group="3sæé€Ÿå¤åˆ»",
    prompt_text="åƒè€ƒæ–‡å­—",
    prompt_wav_upload=handle_file("voice.wav"),
    api_name="/generate_audio"
)
```

### Podcast é›™è²é…ç½®
- **Barry**: é›¶æ¨£æœ¬å…‹éš†ï¼ˆç”¨éŒ„éŸ³æ¨£æœ¬ï¼‰
- **Maggie**: é›¶æ¨£æœ¬å…‹éš†ï¼ˆç”¨å¥³ç”Ÿæœ‹å‹éŒ„éŸ³ï¼‰æˆ–é è¨­ã€Œä¸­æ–‡å¥³ã€

## å¾…è¾¦
- [x] å®‰è£ gradio_client ä¸¦é€£ç·š Windows Gradio
- [ ] ä¿®å¾© Windows API çš„ 403 Forbiddenï¼ˆéœ€æ”¹ webui.py çš„ allowed_pathsï¼‰
- [ ] å»ºç«‹å®Œæ•´çš„ Gradio client TTS è…³æœ¬
- [ ] æ•´åˆåˆ°æ¯æ—¥ Podcast è‡ªå‹•åŒ–æµç¨‹
- [ ] æ¸¬è©¦ Windows GPU é€Ÿåº¦ï¼ˆé æœŸå¿« 10 å€ï¼‰

## æŠ€è¡“ç­†è¨˜
- CosyVoice3 åªæ”¯æŒè²éŸ³å…‹éš†ï¼Œç„¡é è¨“ç·´éŸ³è‰²
- Gradio WebUI éœ€è¨­å®š `allowed_paths` æ‰èƒ½é ç«¯ä¸‹è¼‰
- Mac mini ç”¨ conda + Python 3.10ï¼ˆPython 3.13 ä¸ç›¸å®¹ï¼‰
- é˜¿é‡Œé›²é¡åƒæ¯”æ¸…è¯é¡åƒå¿«ä¸”ç©©å®š
